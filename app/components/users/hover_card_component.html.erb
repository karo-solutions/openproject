<%=
    if @user.present?
      flex_layout(classes: 'op-user-hover-card') do |flex|
        flex.with_row do
          render(Users::AvatarComponent.new(user: @user, show_name: false, size: :large))
        end

        flex.with_row do
          flex_layout(classes: 'op-user-hover-card-user-info') do |f|
            f.with_column do
              render(Primer::Beta::Text.new(font_weight: :semibold)) { @user.name }
            end

            if show_email?
              f.with_column do
                render(Primer::Beta::Text.new(color: :muted)) { @user.mail } # TODO: only with permission
              end
            end
          end
        end

        flex.with_row do
          flex_layout(classes: 'op-user-hover-card-project-list') do |f|
            f.with_column do
              render(Primer::Beta::Octicon.new(icon: :people))
            end

            f.with_column do
              render(Primer::Beta::Text.new(color: :muted)) { project_membership_summary }
            end
          end
        end

        flex.with_row do
          # TODO: could also use helpers.allowed_management_user_profile_path here...
          render(Primer::Beta::Button.new(tag: :a, href: user_path(@user))) do
            "Open profile"
          end
        end
      end
    else
      render Primer::Beta::Blankslate.new(border: false, narrow: true) do |component|
        component.with_visual_icon(icon: "x-circle")
        # TODO: fix 404 string
        component.with_heading(tag: :h3).with_content(I18n.t("api_v3.errors.not_found.work_package"))
      end
    end
%>
